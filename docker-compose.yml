version: '3.4'

services:
  ###################
  crawler:
    build:
      context: ./crawler
      dockerfile: ./Dockerfile
    env_file:
     - production.env      
    volumes:
      - scrapyd-logs-data:/app/logs
      - scrapyd-dbs-data:/app/dbs
  schedule:
    build:
      context: ./schedule
      dockerfile: ./Dockerfile
    env_file:
     - production.env          
    depends_on:
      - crawler
  ###################
  web_site:
    build:
      context: ./web_site
      dockerfile: ./Dockerfile
    env_file:
     - production.env    
    depends_on:
      - crawler  
  ###################
  reverse_proxy_server:
    build:
      context: ./reverse_proxy_server
      dockerfile: ./Dockerfile 
    ports:
    - "5269:80"
    depends_on:
      - crawler
      - web_site
volumes:
  scrapyd-logs-data:
  scrapyd-dbs-data: