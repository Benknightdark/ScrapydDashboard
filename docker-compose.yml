version: '3.4'

services:
  ###################
  crawler:
    build:
      context: ./crawler
      dockerfile: ./Dockerfile
    env_file:
     - production.env       
    volumes:
      - ./logs:/app/logs
  schedule:
    build:
      context: ./schedule
      dockerfile: ./Dockerfile
    env_file:
     - production.env      
    # environment:
    #   - SCRAPYD_URL=http://crawler:6800      
    depends_on:
      - crawler
  ###################
  web_site:
    build:
      context: ./web_site
      dockerfile: ./Dockerfile
    # environment:
    #   - SCRAPYD_URL=http://crawler:6800
    env_file:
     - production.env    
    depends_on:
      - crawler  
  ###################
  reverse_proxy_server:
    build:
      context: ./reverse_proxy_server
      dockerfile: ./Dockerfile 
    ports:
    - "5269:80"
    depends_on:
      - crawler
      - web_site
